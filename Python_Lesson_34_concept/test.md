test.md

1.準確的需求說明

開發軟件時，必須先知道軟件要解決什麼問題——要實現什麼樣的目標。要闡明程序的目標，可編寫需求說明，也就是描述程序必須滿足何種需求的文檔（或便條）。這樣以後就很容易核實需求是否確定得到了滿足。不過很多程序員不喜歡撰寫報告，更願意讓計算機替他們完成盡可能多的工作。可以使用Python來描述需求，並讓解釋器檢查是否滿足了這些需求。

這裡介紹的重點是功能需求，即程序必須提供哪些功能。

這裡的理念是先編寫測試，再編寫讓測試通過的程序。測試程序就是需求說明，可幫助確保程序開發過程緊扣這些需求。

先編寫測試再編寫代碼並不是為了發現bug，而是為了檢查代碼是否管用。這有點像古老的禪語所說：如果沒有人聽到，就認為森林中的樹木倒下時沒有發出聲音嗎？當然不是，但發出的聲明對任何人都沒有影響。對代碼而言，問題就是：除非有相應的測試，否則該功能就並不存在，或者說不是真正意義上的功能。這樣你就能名正言順地證明它確實存在，而且做了它應該做的。這不僅對最初開發程序有幫助，對以後擴展和維護代碼也有幫助。

簡單示例：

假設要編寫一個模塊，其中只包含一個根據矩形的寬度和高度計算面積的函數。動手編寫代碼前，編寫一個單元測試，其中包含一些你知道答案的例子。這個測試程序可能類似於代下面的碼清單所示。

簡單的測試程序
from area import rect_area
height = 3
width = 4
correct_answer = 12
answer = rect_area(height, width)
if answer == correct_answer:
    print('Test passed')
else:
    print('Test failed')

在這個示例中，調用函數rect_area，並將參數height和width分別設置為3和4，再將結果與正確答案（12）進行比較。

當然，只測試這樣一種情況並不能確信代碼是正確的。真正的測試程序可能詳盡得多。

如果接下來（在文件area.py中）不小心將函數rect_area實現為下面這樣，並嘗試運行測試程序，將出現一條錯誤消息。

def rect_area(height,width):
    return height * height #這不對...

接下來，可能檢查代碼，看看問題出在什麼地方，並將返回的表達式替換為height * width。

2.做好應對變化的準備

自動化測試不僅可在編寫程序時提供極大的幫助，還有助於在修改代碼時避免累積錯誤，這在程序規模很大時尤其重要。

必須做好修改代碼的心理準備，而不是固守既有代碼，但修改是有風險的。

修改代碼時，常常會引入一兩個意想不到的bug。

如果程序設計良好（使用了合適的抽象和封裝），修改帶來的影響將是局部的，只會影響很小一段代碼。這意味著你能夠確定bug的範圍，因此調適起來更容易。

3.測試四部曲

在深入介紹編寫測試細節之前，先來看看測試驅動開發過程的各個階段（至少有個版本是這樣的）。

1.確定需要實現的新功能。可將其記錄下來，再為之編寫一個測試。
2.編寫實現功能的框架代碼，讓程序能夠運行（不存在語法錯誤之類的問題），但測試依然無法通過。測試失敗是很重要的，因為這樣才能確定它可能失敗。如果測試有錯誤，導致在任何情況下都能成功（這樣的情況很多），那麼它實際上什麼都沒有測試。不斷重複這個過程：確定測試失敗後，再試圖讓它成功。
3.編寫讓測試剛好能夠通過的代碼。在這個階段，無須完全實現所需的功能，而只要讓測試能夠通過即可。這樣，在整個開發階段，都能夠讓所有的測試通過（首次運行測試時除外），即便是剛著手實現功能時亦如此。
4.改進（重構）代碼以全面而準確地實現所需的功能，同時確保測試依然能夠成功。

提交代碼時，必須確保它們處於健康狀態，即沒有任何測試是失敗的。測試驅動編程倡導者都是這麼說的。

在任何情況下，都不應將存在失敗測試的代碼提交到公共代碼庫。